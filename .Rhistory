{
partial_equation = intercept
for (variable in seq(n_variables))
{
partial_equation <- partial_equation + ifelse(simulation1$DF[,variable],coeffs_vect[variable],0)
}
y <-  exp(partial_equation)/(1 + exp(partial_equation))
prob = mean(y)
(mean(prob_inf,prob_sup) - prob)*10*log(n + 1) -> coeff
intercept <- intercept + (coeff * abs(intercept))
print(prob)
print(intercept)
n <-  n + 1
}
intercept
for (var in seq(y))
{
y_var[var] <- rbernoulli(1,y[var])
}
y_var
DF <- cbind(y_var, simulation1$DF)
# Not meningful factors
simulate_dataset(N,3) -> DF2
cbind(DF,DF2) -> DF
# vectors of odds ratios / vectors :
OR_vect = c(0.4,6,0.5,3,1.2)
coeffs_vect <- log(OR_vect)
intercept = 1
prob = 1
n = 1
y_var = vector()
while (prob < prob_inf || prob > prob_sup)
{
partial_equation = intercept
for (variable in seq(n_variables))
{
partial_equation <- partial_equation + ifelse(simulation1$DF[,variable],coeffs_vect[variable],0)
}
y <-  exp(partial_equation)/(1 + exp(partial_equation))
prob = mean(y)
(mean(prob_inf,prob_sup) - prob)*10*log(n + 1) -> coeff
intercept <- intercept + (coeff * abs(intercept))
print(prob)
print(intercept)
n <-  n + 1
}
intercept
for (var in seq(y))
{
y_var[var] <- rbernoulli(1,y[var])
}
y_var
DF <- cbind(y_var, simulation1$DF)
# Not meningful factors
simulate_dataset(N,3) -> DF2
cbind(DF,DF2) -> DF
DF2
DF
cbind(DF,DF2) -> DF
DF2
cbind(DF,DF2) -> DF
cbind(DF,DF2)
DF2
DF
DF2
DF2
# Not meningful factors
simulate_dataset(N,3) -> DF2
colnames(DF2) <- c("interact1","interact2","interact3")
DF2
# Not meningful factors
simulate_dataset(N,3)$DF -> DF2
colnames(DF2) <- c("interact1","interact2","interact3")
cbind(DF,DF2) -> DF
reglog(DF,"y_var")
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 100
for (i in 1:nbre)
{
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
newDF$toxiques <- NULL
s_dev_back <- multivariate_selection(newDF,
y = "Récidive",
criteria = "BIC",
method = "backward")
for (var in colnames(DF)[colnames(DF) != y])
{
if (var %in% s_dev_back$vars_multi)
{
rslt[match(var,rslt[,1]),2] <- as.numeric(rslt[match(var,rslt[,1]),2]) + 1
}
}
}
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 100
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
newDF$toxiques <- NULL
s_dev_back <- multivariate_selection(newDF,
y = "Récidive",
criteria = "BIC",
method = "backward")
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 100
for (i in 1:nbre)
{
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
s_dev_back <- multivariate_selection(newDF,
y = "var_y",
criteria = "BIC",
method = "backward")
for (var in colnames(DF)[colnames(DF) != y])
{
if (var %in% s_dev_back$vars_multi)
{
rslt[match(var,rslt[,1]),2] <- as.numeric(rslt[match(var,rslt[,1]),2]) + 1
}
}
}
s_dev_back <- multivariate_selection(newDF,
y = "var_y",
criteria = "BIC",
method = "backward")
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 100
for (i in 1:nbre)
{
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
s_dev_back <- multivariate_selection(newDF,y = "y_var")
for (var in colnames(DF)[colnames(DF) != y])
{
if (var %in% s_dev_back$vars_multi)
{
rslt[match(var,rslt[,1]),2] <- as.numeric(rslt[match(var,rslt[,1]),2]) + 1
}
}
}
round((as.numeric(rslt[,2])/nbre)*100,1) -> rslt[,2]
as.data.frame(rslt[order(as.numeric(rslt[,2])),]) -> rslt
colnames(rslt) <- c("variables","% inclusion")
rslt %>% kable()
library(kableExtra)
rslt %>% kable()
y="y_var"
y="y_var"
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 10
for (i in 1:nbre)
{
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
s_dev_back <- multivariate_selection(newDF,y = "y_var")
for (var in colnames(DF)[colnames(DF) != y])
{
if (var %in% s_dev_back$vars_multi)
{
rslt[match(var,rslt[,1]),2] <- as.numeric(rslt[match(var,rslt[,1]),2]) + 1
}
}
}
round((as.numeric(rslt[,2])/nbre)*100,1) -> rslt[,2]
as.data.frame(rslt[order(as.numeric(rslt[,2])),]) -> rslt
colnames(rslt) <- c("variables","% inclusion")
rslt %>% kable()
y="y_var"
rslt <- matrix(ncol = 2,nrow = length(colnames(DF)[colnames(DF) != y]))
rslt[,1] <- colnames(DF)[colnames(DF) != y]
rslt[,2] <- rep(0,nrow(rslt))
nbre = 100
for (i in 1:nbre)
{
sample(nrow(DF), nrow(DF), replace = TRUE) -> colDF
newDF <- DF[colDF, ]
s_dev_back <- multivariate_selection(newDF,y = "y_var")
for (var in colnames(DF)[colnames(DF) != y])
{
if (var %in% s_dev_back$vars_multi)
{
rslt[match(var,rslt[,1]),2] <- as.numeric(rslt[match(var,rslt[,1]),2]) + 1
}
}
}
round((as.numeric(rslt[,2])/nbre)*100,1) -> rslt[,2]
as.data.frame(rslt[order(as.numeric(rslt[,2])),]) -> rslt
colnames(rslt) <- c("variables","% inclusion")
rslt %>% kable()
remove.packages("autostats")
devtools::install_github("TanguyPerennec/Autostats")
devtools::install_github("TanguyPerennec/Autostats")
load("~/MEGA/ARTICLES/Packages/autostats/.RData")
usethis::use_package('kable_extra')
library(kableExtra)
usethis::use_package('kableExtra')
usethis::use_package('readr')
library(autostats)
library(autostats)
library(autostats)
library(readxl)
library(tidyverse)
library(stringr)
#library(autostats)
##################
# DATA CLEANING  #
##################
DFinit <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "données recueillies",
range = "B1:AA109")
DF <- DFinit
DF2 <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "données recueillies en codage",
range = "B1:AA109")
codage <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "codage des variables")
#view(DFinit)
#transformation de l'âge
DF %>%
separate(Age, c("années", "mois"),sep = "a") -> DF
str_replace_all(DF$mois, c("mois" = "","ns" = "")) -> DF$mois
as.numeric(DF$mois) -> DF$mois
as.numeric(DF$années) -> DF$années
DF$mois <- round(DF$mois*10/120,2)
DF$mois[is.na(DF$mois)] <- 0 #pas de NA initialement mais introduits si mois =""
DF$années <- DF$années + DF$mois
DF %>%
select(-mois) -> DF
colnames(DF)[2] <- "Age"
#modif colonnes
DF <- as.data.frame(DF)
DF$Sexe[DF$Sexe == "masculin"] <- "homme"
DF[DF == 9] <- NA
DF[DF == "non renseigné"] <- NA
DF[DF == "?"] <- NA
DF[DF == "aucun"] <- "non"
DF[DF == "aucune"] <- "non"
DF[DF == "sacrifications"] <- "scarifications"
#DF$mode <- str_replace(DF$mode, "ts par ", "")
#DF$mode <- str_replace(DF$mode, "intoxication aux ", "ingestion de ")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur précipitant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur precipitant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur declenchant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "cause", "situation")
DF$scolarite <- str_replace_all(DF$scolarite, c("descolarisé"="descolarisation", "descolarisée"="descolarisation", "difficulté"="difficultés","difficulte"="difficultés","scolaire"="scolaires","ss"="s"))
DF$scolarite <- str_replace(DF$scolarite, "scolarisation", "scolarite")
levels(as.factor(DF$scolarite))
DF$scolarite[DF$scolarite == "descolaritee"] <- "descolarite"
DF$scolarite[DF$scolarite == "difficulés scolaires"] <- "difficultés scolaires"
DF$scolarite[DF$scolarite == "ITEP"] <- "difficultés scolaires"
DF$scolarite[DF$scolarite == "scolarite clasique"] <- "scolarité clasique"
DF$scolarite[DF$scolarite == "scolarité clasique"] <- "scolarité classique"
DF$scolarite <- str_replace(DF$scolarite, ", redoublement", "")
DF$scolarite <- as.factor(DF$scolarite)
DF$scolarite <- relevel(DF$scolarite,"scolarité classique")
DF$diagnostic <- str_replace(DF$diagnostic, "troubles", "trouble")
DF$TTT <- str_replace(DF$diagnostic, "anxiolytiques seuls", "anxiolytique seul")
#le changement de la casse/accents à lieu dans table1
########### CODAGE
# mode : concernant le mode tu peux mettre soit IMV, soit tentative de pendaison, soit autre
DF2[DF2 == 9] <- NA
DF2$Mode[DF2$Mode == 0] <- "IMV"
DF2$Mode[DF2$Mode == 1] <- "IMV"
DF2$Mode[DF2$Mode == 2] <- "Tentative de pendaison"
DF2$Mode[DF2$Mode == 3] <- "Autre"
DF$mode <- as.factor(DF2$Mode)
DF$mode <- relevel(DF$mode,"Autre")
#Pour l’orientation : hospitalisation, consultation ou rien
DF2$orientation[DF2$orientation == 0] <- "RAD sans RDV"
DF2$orientation[DF2$orientation == 1] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 2] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 3] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 4] <- "Hospitalisation"
DF2$orientation[DF2$orientation == 5] <- "Hospitalisation"
DF$orientation <- as.factor(DF2$orientation)
DF$orientation <- relevel(DF$orientation,"RAD sans RDV")
DF2$conduite_risque[DF2$conduite_risque == 0] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 1 | DF2$conduite_risque == "1 et 4"] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 2] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 3] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 4] <- "Scarifications non suicidaires"
DF$conduite_risque <- as.factor(DF2$conduite_risque)
DF$conduite_risque <- relevel(DF$conduite_risque,"Non")
DF2$lieu_vie[DF2$lieu_vie == 0] <- "Chez les 2 parents"
DF2$lieu_vie[DF2$lieu_vie == 1] <- "Chez un des deux parents"
DF2$lieu_vie[DF2$lieu_vie == 2] <- "Placement"
DF2$lieu_vie[DF2$lieu_vie == 3] <- "Autre"
DF$lieu_vie <- as.factor(DF2$lieu_vie)
DF$lieu_vie <- relevel(DF$lieu_vie,"Autre")
DF2$suivi[DF2$suivi == 0] <- "non"
DF2$suivi[DF2$suivi == 1] <- "psychologue libéral"
DF2$suivi[DF2$suivi == 2] <- "psychiatre libéral"
DF2$suivi[DF2$suivi == 3] <- "CMP"
DF2$suivi[DF2$suivi == 4] <- "Autre"
DF$suivi <- as.factor(DF2$suivi)
DF$suivi <- relevel(DF$suivi,"non")
DF2$TTT[DF2$TTT == 0] <- "non"
DF2$TTT[DF2$TTT == 1] <- "oui"
DF2$TTT[DF2$TTT == 2] <- "oui"
DF2$TTT[DF2$TTT == 3] <- "oui"
DF2$TTT[DF2$TTT == 4] <- "oui"
DF2$TTT[DF2$TTT == 5] <- "oui"
DF$TTT <- as.factor(DF2$TTT)
DF$TTT <- relevel(DF$TTT,"non")
#Pour le diagnostic : épisode anxio dépressif, troubles des conduites (=trouble de la personnalité), trouble psychotique, TDAH et trouble bipolaire. Les 3 derniers ça peut être regrouper en « autre » si il y en a peu
DF2$diagnostic[DF2$diagnostic == 0] <- "non"
DF2$diagnostic[DF2$diagnostic == 1] <- "épisode anxio-dépressif"
DF2$diagnostic[DF2$diagnostic == 2] <- "trouble psychotique"
DF2$diagnostic[DF2$diagnostic == 3] <- "autre"
DF2$diagnostic[DF2$diagnostic == 4] <- "autre"
DF2$diagnostic[DF2$diagnostic == 5] <- "trouble des conduites"
DF2$diagnostic[DF2$diagnostic == 6] <- "autre"
DF2$diagnostic[DF2$diagnostic == 7] <- "épisode anxio-dépressif"
DF2$diagnostic[DF2$diagnostic == 8] <- "autre"
DF$diagnostic <- as.factor(DF2$diagnostic)
DF$diagnostic <- relevel(DF$diagnostic,"non")
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 0] <- "non"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 1] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 2] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 3] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 4] <- "oui"
DF$antecedent_familiaux <- as.factor(DF2$antecedent_familiaux)
DF$antecedent_familiaux <- relevel(DF$antecedent_familiaux,"non")
DF2$facteur_precipitant[DF2$facteur_precipitant == 0] <- "non"
DF2$facteur_precipitant[DF2$facteur_precipitant == 1] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 2] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 3] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 4] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 5] <- "oui"
DF$facteur_precipitant <- as.factor(DF2$facteur_precipitant)
DF$facteur_precipitant <- relevel(DF$facteur_precipitant,"non")
DF$hospitalisation_anterieure[DF$hospitalisation_anterieure == "passage aux UMP"] <- "non"
DF$hospitalisation_anterieure <- as.factor(DF$hospitalisation_anterieure)
relevel(DF$hospitalisation_anterieure,"oui")
DF$toxiques <- NULL
DF$mesure_sociale <- NULL
DF$suivi <- NULL
DF$pathologie_somatique <- NULL
##############
colnames(DF)[14] <- "études"
# TABLE 1
table1(DF,"Récidive",ynames=c("Pas de récidive","Récidive")) -> tabf
table(DF$cannabis,DF$Récidive)
# Reglog
DF$relation_famille <- NULL
reglog(DF,"Récidive",method = "forward",keep = c("abus","cannabis","maltraitance","orientation","TS","hospitalisation_anterieure","diagnostic","études","antecedent_familiaux","TTT"),exit = "excel")
y = "Récidive"
DF[,y] <- tobinary(DF[,y])
mod <- glm(formulation(c("Récidive","cannabis","abus","maltraitance","orientation","TS","TTT","hospitalisation_anterieure","diagnostic","études","antecedent_familiaux")),family="binomial",data=DF)
summary(mod)
table(DF$conduite_risque,DF$Récidive)
devtools::load_all(".")
library(readxl)
library(tidyverse)
library(stringr)
#library(autostats)
##################
# DATA CLEANING  #
##################
DFinit <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "données recueillies",
range = "B1:AA109")
DF <- DFinit
DF2 <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "données recueillies en codage",
range = "B1:AA109")
codage <- read_excel("~/MEGA/ARTICLES/CDD/These_psychiatrie/Datas/Copie de Copie de thèse.xlsx",
sheet = "codage des variables")
#view(DFinit)
#transformation de l'âge
DF %>%
separate(Age, c("années", "mois"),sep = "a") -> DF
str_replace_all(DF$mois, c("mois" = "","ns" = "")) -> DF$mois
as.numeric(DF$mois) -> DF$mois
as.numeric(DF$années) -> DF$années
DF$mois <- round(DF$mois*10/120,2)
DF$mois[is.na(DF$mois)] <- 0 #pas de NA initialement mais introduits si mois =""
DF$années <- DF$années + DF$mois
DF %>%
select(-mois) -> DF
colnames(DF)[2] <- "Age"
#modif colonnes
DF <- as.data.frame(DF)
DF$Sexe[DF$Sexe == "masculin"] <- "homme"
DF[DF == 9] <- NA
DF[DF == "non renseigné"] <- NA
DF[DF == "?"] <- NA
DF[DF == "aucun"] <- "non"
DF[DF == "aucune"] <- "non"
DF[DF == "sacrifications"] <- "scarifications"
#DF$mode <- str_replace(DF$mode, "ts par ", "")
#DF$mode <- str_replace(DF$mode, "intoxication aux ", "ingestion de ")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur précipitant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur precipitant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "facteur declenchant : ", "")
DF$facteur_precipitant <- str_replace(DF$facteur_precipitant, "cause", "situation")
DF$scolarite <- str_replace_all(DF$scolarite, c("descolarisé"="descolarisation", "descolarisée"="descolarisation", "difficulté"="difficultés","difficulte"="difficultés","scolaire"="scolaires","ss"="s"))
DF$scolarite <- str_replace(DF$scolarite, "scolarisation", "scolarite")
levels(as.factor(DF$scolarite))
DF$scolarite[DF$scolarite == "descolaritee"] <- "descolarite"
DF$scolarite[DF$scolarite == "difficulés scolaires"] <- "difficultés scolaires"
DF$scolarite[DF$scolarite == "ITEP"] <- "difficultés scolaires"
DF$scolarite[DF$scolarite == "scolarite clasique"] <- "scolarité clasique"
DF$scolarite[DF$scolarite == "scolarité clasique"] <- "scolarité classique"
DF$scolarite <- str_replace(DF$scolarite, ", redoublement", "")
DF$scolarite <- as.factor(DF$scolarite)
DF$scolarite <- relevel(DF$scolarite,"scolarité classique")
DF$diagnostic <- str_replace(DF$diagnostic, "troubles", "trouble")
DF$TTT <- str_replace(DF$diagnostic, "anxiolytiques seuls", "anxiolytique seul")
#le changement de la casse/accents à lieu dans table1
########### CODAGE
# mode : concernant le mode tu peux mettre soit IMV, soit tentative de pendaison, soit autre
DF2[DF2 == 9] <- NA
DF2$Mode[DF2$Mode == 0] <- "IMV"
DF2$Mode[DF2$Mode == 1] <- "IMV"
DF2$Mode[DF2$Mode == 2] <- "Tentative de pendaison"
DF2$Mode[DF2$Mode == 3] <- "Autre"
DF$mode <- as.factor(DF2$Mode)
DF$mode <- relevel(DF$mode,"Autre")
#Pour l’orientation : hospitalisation, consultation ou rien
DF2$orientation[DF2$orientation == 0] <- "RAD sans RDV"
DF2$orientation[DF2$orientation == 1] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 2] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 3] <- "RAD avec consultation"
DF2$orientation[DF2$orientation == 4] <- "Hospitalisation"
DF2$orientation[DF2$orientation == 5] <- "Hospitalisation"
DF$orientation <- as.factor(DF2$orientation)
DF$orientation <- relevel(DF$orientation,"RAD sans RDV")
DF2$conduite_risque[DF2$conduite_risque == 0] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 1 | DF2$conduite_risque == "1 et 4"] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 2] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 3] <- "Non"
DF2$conduite_risque[DF2$conduite_risque == 4] <- "Scarifications non suicidaires"
DF$conduite_risque <- as.factor(DF2$conduite_risque)
DF$conduite_risque <- relevel(DF$conduite_risque,"Non")
DF2$lieu_vie[DF2$lieu_vie == 0] <- "Chez les 2 parents"
DF2$lieu_vie[DF2$lieu_vie == 1] <- "Chez un des deux parents"
DF2$lieu_vie[DF2$lieu_vie == 2] <- "Placement"
DF2$lieu_vie[DF2$lieu_vie == 3] <- "Autre"
DF$lieu_vie <- as.factor(DF2$lieu_vie)
DF$lieu_vie <- relevel(DF$lieu_vie,"Autre")
DF2$suivi[DF2$suivi == 0] <- "non"
DF2$suivi[DF2$suivi == 1] <- "psychologue libéral"
DF2$suivi[DF2$suivi == 2] <- "psychiatre libéral"
DF2$suivi[DF2$suivi == 3] <- "CMP"
DF2$suivi[DF2$suivi == 4] <- "Autre"
DF$suivi <- as.factor(DF2$suivi)
DF$suivi <- relevel(DF$suivi,"non")
DF2$TTT[DF2$TTT == 0] <- "non"
DF2$TTT[DF2$TTT == 1] <- "oui"
DF2$TTT[DF2$TTT == 2] <- "oui"
DF2$TTT[DF2$TTT == 3] <- "oui"
DF2$TTT[DF2$TTT == 4] <- "oui"
DF2$TTT[DF2$TTT == 5] <- "oui"
DF$TTT <- as.factor(DF2$TTT)
DF$TTT <- relevel(DF$TTT,"non")
#Pour le diagnostic : épisode anxio dépressif, troubles des conduites (=trouble de la personnalité), trouble psychotique, TDAH et trouble bipolaire. Les 3 derniers ça peut être regrouper en « autre » si il y en a peu
DF2$diagnostic[DF2$diagnostic == 0] <- "non"
DF2$diagnostic[DF2$diagnostic == 1] <- "épisode anxio-dépressif"
DF2$diagnostic[DF2$diagnostic == 2] <- "trouble psychotique"
DF2$diagnostic[DF2$diagnostic == 3] <- "autre"
DF2$diagnostic[DF2$diagnostic == 4] <- "autre"
DF2$diagnostic[DF2$diagnostic == 5] <- "trouble des conduites"
DF2$diagnostic[DF2$diagnostic == 6] <- "autre"
DF2$diagnostic[DF2$diagnostic == 7] <- "épisode anxio-dépressif"
DF2$diagnostic[DF2$diagnostic == 8] <- "autre"
DF$diagnostic <- as.factor(DF2$diagnostic)
DF$diagnostic <- relevel(DF$diagnostic,"non")
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 0] <- "non"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 1] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 2] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 3] <- "oui"
DF2$antecedent_familiaux[DF2$antecedent_familiaux == 4] <- "oui"
DF$antecedent_familiaux <- as.factor(DF2$antecedent_familiaux)
DF$antecedent_familiaux <- relevel(DF$antecedent_familiaux,"non")
DF2$facteur_precipitant[DF2$facteur_precipitant == 0] <- "non"
DF2$facteur_precipitant[DF2$facteur_precipitant == 1] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 2] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 3] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 4] <- "oui"
DF2$facteur_precipitant[DF2$facteur_precipitant == 5] <- "oui"
DF$facteur_precipitant <- as.factor(DF2$facteur_precipitant)
DF$facteur_precipitant <- relevel(DF$facteur_precipitant,"non")
DF$hospitalisation_anterieure[DF$hospitalisation_anterieure == "passage aux UMP"] <- "non"
DF$hospitalisation_anterieure <- as.factor(DF$hospitalisation_anterieure)
relevel(DF$hospitalisation_anterieure,"oui")
DF$toxiques <- NULL
DF$mesure_sociale <- NULL
DF$suivi <- NULL
DF$pathologie_somatique <- NULL
##############
colnames(DF)[14] <- "études"
# TABLE 1
table1(DF,"Récidive",ynames=c("Pas de récidive","Récidive")) -> tabf
table(DF$cannabis,DF$Récidive)
# Reglog
DF$relation_famille <- NULL
reglog(DF,"Récidive",method = "forward",keep = c("abus","cannabis","maltraitance","orientation","TS","hospitalisation_anterieure","diagnostic","études","antecedent_familiaux","TTT"),exit = "excel")
y = "Récidive"
DF[,y] <- tobinary(DF[,y])
mod <- glm(formulation(c("Récidive","cannabis","abus","maltraitance","orientation","TS","TTT","hospitalisation_anterieure","diagnostic","études","antecedent_familiaux")),family="binomial",data=DF)
summary(mod)
