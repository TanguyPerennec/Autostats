########################
#     Regression       #
########################
DF$age_diag
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","tabac","age_diag"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$moisissures
########################
#     Regression       #
########################
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","tabac","age_diag","MAI"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","tabac","age_diag"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$atopie
########################
#     Regression       #
########################
DF$cofacteur
########################
#     Regression       #
########################
DF$tabac
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer","IRespi_chronique"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$IRespi_chronique
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$delai_diag
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","delai_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","delai_diag"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
########################
#     Regression       #
########################
DF$
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
glm(family = binomial,data = DF,formula = nouvelle_AA~atopie+cofacteur+age_diag)
glm(family = binomial,data = DF,formula = nouvelle_AA~atopie+cofacteur+age_diag)$summary
summary(glm(family = binomial,data = DF,formula = nouvelle_AA~atopie+cofacteur+age_diag))
exp(-35.3)
_1.07-
exp(-1.07)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE)
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE) -> rslt
propensity(rslt,DF,y="nouvelle_AA")
reglog(DF,"nouvelle_AA",explicatives = c("sexe","atopie","cofacteur","age_diag","MAI","cancer"),keep = c("atopie","cofacteur"),title = FALSE,exit = "console") -> rslt
propensity(rslt,DF,y="nouvelle_AA")
rslt
propensity(DF,y="nouvelle_AA",rslt)
tobinary(DF[,"nouvelle_AA"])
propensity(DF,y="nouvelle_AA",rslt)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(readxl) # fast excel reader
library(table1)
library(rticles) #template
library(tidyverse)
library(finalfit)
library(kableExtra)
library(dplyr)
library(SubgrPlots)
library(ggpubr)
library(rstatix)
DF <- read_xlsx('data/Base modifiée.xlsx', na=",")
?read_xlsx
DF <- readxl::read_xlsx('data/Base modifiée.xlsx', na=",")
library(dplyr)
n_NA <- sapply(DF,function(x) round(100*sum(is.na(x))/72,1))
n_NA <- data.frame(n_NA)
n_NA %>%
mutate(
Colonnes = row.names(.),
n_NA = cell_spec(n_NA, "html", color = ifelse(n_NA > 40, "red", "blue"))) %>%
select(Colonnes, n_NA) %>%
kable(format = "html", escape = F, digits = 1) %>%
kable_styling(bootstrap_options = c("striped", "hover","condensed","responsive",full_width = F), position = "center") %>%
scroll_box(width = "300px", height = "350px")
library(Amelia)
missmap(DF, main = "Données manquantes")
library(table1)
DF2 <- DF
DF2$bras <- factor(DF2$bras, levels=c("RADIOTHERAPIE EXCLUSIVE","RADIOTHERAPIE HORMONOTHERAPIE","p"),
labels=c("Exclusive radiotherapy", "Hormonotherapy radiotherapy", 'P-value'))
DF2$HTA <- factor(DF2$HTA, levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$HTA) <- "Hypertension"
DF2$Diabète <- factor(DF2$Diabète, levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$Diabète) <- "Diabetes"
DF2$Tabagisme <- factor(DF2$Tabagisme, levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$Tabagisme) <- "Smoking"
DF2$`Chirurgie ano-rectale` <- factor(DF2$`Chirurgie ano-rectale`,levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$`Chirurgie ano-rectale`) <- "Ano-rectal surgery"
DF2$`ATCD Cardio` <- factor(DF2$`ATCD Cardio`,levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$`ATCD Cardio`) <- "Cardiovascular desease"
DF2$`ATCD psy` <- factor(DF2$`ATCD psy`,levels=c("Non","Oui"),labels=c("No", "Yes"))
label(DF2$`ATCD psy`) <- "Psychiatric desease"
label(DF2$`Poids [kg]...9`) <- "Weight"
units(DF2$`Poids [kg]...9`) <- "kg"
label(DF2$`Age à la randomisation`) <- "Age"
DF2$Agecat <- cut(DF2$`Age à la randomisation`, c(75,78,80,85))
label(DF2$Agecat) <- "Age"
units(DF2$`Age à la randomisation`) <- "years"
units(DF2$Agecat) <- "years"
label(DF2$`globalqol`) <- "Global quality of life"
label(DF2$score_IADL_0) <- "IADL score"
rndr <- function(x, name, ...) {
if (length(x) == 0) {
y <- DF2[[name]]
s <- rep("", length(render.default(x=y, name=name, ...)))
if (is.numeric(y)) {
p <- t.test(y ~ DF2$bras)$p.value}
else {
p <- chisq.test(table(y, droplevels(DF2$bras)))$p.value}
s[2] <- sub("<", "&lt;", format.pval(p, digits=3, eps=0.001))
s}
else {
render.default(x=x, name=name, ...)
}
}
rndr.strat <- function(label, n, ...) {ifelse(n==0, label, render.strat.default(label, n, ...))}
table1(~ `Age à la randomisation` + Agecat + HTA + Diabète + Tabagisme + `Chirurgie ano-rectale` + `Poids [kg]...9` + `globalqol` +  `score_IADL_0` + `ATCD Cardio` + `ATCD psy` | bras, data=DF2, render=rndr, render.strat=rndr.strat,droplevels=F,overall=F, render.continuous=c(.= "Median", .="Mean [Min, Max]"),)
table1::table1(~ `Age à la randomisation` + Agecat + HTA + Diabète + Tabagisme + `Chirurgie ano-rectale` + `Poids [kg]...9` + `globalqol` +  `score_IADL_0` + `ATCD Cardio` + `ATCD psy` | bras, data=DF2, render=rndr, render.strat=rndr.strat,droplevels=F,overall=F, render.continuous=c(.= "Median", .="Mean [Min, Max]"),)
table1::table1(~ Agecat + HTA + Diabète + Tabagisme  + `ATCD Cardio` + `ATCD psy` +`score_IADL_0` + `globalqol`| bras_sansp, data=DF2, droplevels=F,overall=F, render.continuous=c(.="Mean [Min, Max]"),)
DF2$bras_sansp <- factor(DF$bras, levels=c("RADIOTHERAPIE EXCLUSIVE","RADIOTHERAPIE HORMONOTHERAPIE"),
labels=c("Exclusive radiotherapy", "Hormonotherapy radiotherapy"))
table1::table1(~ Agecat + HTA + Diabète + Tabagisme  + `ATCD Cardio` + `ATCD psy` +`score_IADL_0` + `globalqol`| bras_sansp, data=DF2, droplevels=F,overall=F, render.continuous=c(.="Mean [Min, Max]"),)
DF %>%
select(`Age à la randomisation`,HTA,Diabète,Tabagisme,`Chirurgie ano-rectale`,`Poids [kg]...9`,`globalqol`,`score_IADL_0`,`ATCD Cardio`,`ATCD psy`) %>%
select_if(is.numeric) %>%
gather(variable, value) %>%
ggplot(aes(y=value,x=variable, fill=variable, colour=variable))+
geom_boxplot(alpha=0.5)+
facet_wrap(~variable, scales="free")
DF %>%
select(`Age à la randomisation`,HTA,Diabète,Tabagisme,`Chirurgie ano-rectale`,`Poids [kg]...9`,`globalqol`,`score_IADL_0`,`ATCD Cardio`,`ATCD psy`) %>%
select_if(is.character) %>%
gather(variable, value) %>%
table() %>%
as.data.frame.table() -> DFcat
DFcat <-DFcat[order(DFcat$variable),]
ggplot(DFcat,
aes(x=variable, fill=value, colour=value, y=Freq)) +
geom_col(alpha=0.5) +
facet_wrap(~variable, scales="free")
variables <- c("QLQ-C30 global quality-of-life scores","Number of respondents","QLQ-PR25 urinary symptoms","Number of respondents","QLQ-PR25 bowel symptoms","Number of respondents","QLQ-PR25 treatment-related symptoms","Number of respondents","QLQ-PR25 sexual activity","Number of respondents","QLQ-PR25 sexual function","Number of respondents")
colonne0RT <- c(
round(median(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol)]),0),
length(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol)]),
round(median(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin)]),0),
length(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin)]),
round(median(DF$bow[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow)]),0),
length(DF$bow[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow)]),
round(median(DF$ttt[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt)]),0),
length(DF$ttt[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt)]),
round(median(DF$sexactivity[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity)]),0),
length(DF$sexactivity[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity)]),
round(median(DF$sexfunct[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct)]),0),
length(DF$sexfunct[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct)])
)
colonne1RT <- c(
round(median(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol1)]),0),
length(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol1)]),
round(median(DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin1)]),0),
length(DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin1)]),
round(median(DF$bow1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow1)]),0),
length(DF$bow1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow1)]),
round(median(DF$ttt1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt1)]),0),
length(DF$ttt1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt1)]),
round(median(DF$sexactivity1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity1)]),0),
length(DF$sexactivity1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity1)]),
round(median(DF$sexfunct1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct1)]),0),
length(DF$sexfunct1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct1)]))
colonne5RT <- c(
round(median(DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol5)]),0),
length(DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol5)]),
round(median(DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin5)]),0),
length(DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$urin5)]),
round(median(DF$bow5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow5)]),0),
length(DF$bow5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$bow5)]),
round(median(DF$ttt5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt5)]),0),
length(DF$ttt5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt5)]),
round(median(DF$sexactivity5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity5)]),0),
length(DF$sexactivity5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity5)]),
round(median(DF$sexfunct5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct5)]),0),
length(DF$sexfunct5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct5)]))
colonne0HT <- c(
round(median(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol)]),0),
length(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol)]),
round(median(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin)]),0),
length(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin)]),
round(median(DF$bow[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow)]),0),
length(DF$bow[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow)]),
round(median(DF$ttt[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$ttt)]),0),
length(DF$ttt[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$ttt)]),
round(median(DF$sexactivity[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexactivity)]),0),
length(DF$sexactivity[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexactivity)]),
round(median(DF$sexfunct[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexfunct)]),0),
length(DF$sexfunct[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexfunct)]))
colonne1HT <- c(
round(median(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol1)]),0),
length(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol1)]),
round(median(DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin1)]),0),
length(DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin1)]),
round(median(DF$bow1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow1)]),0),
length(DF$bow1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow1)]),
round(median(DF$ttt1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$ttt1)]),0),
length(DF$ttt1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$ttt1)]),
round(median(DF$sexactivity1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity1)]),0),
length(DF$sexactivity1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexactivity1)]),
round(median(DF$sexfunct1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct1)]),0),
length(DF$sexfunct1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$sexfunct1)]))
colonne5HT <- c(
round(median(DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol5)]),0),
length(DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol5)]),
round(median(DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin5)]),0),
length(DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$urin5)]),
round(median(DF$bow5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow5)]),0),
length(DF$bow5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$bow5)]),
round(median(DF$ttt5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$ttt5)]),0),
length(DF$ttt5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$ttt5)]),
round(median(DF$sexactivity5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexactivity5)]),0),
length(DF$sexactivity5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexactivity5)]),
round(median(DF$sexfunct5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexfunct5)]),0),
length(DF$sexfunct5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$sexfunct5)]))
kable(cbind(variables,colonne0RT,colonne1RT,colonne5RT,colonne0HT,colonne1HT,colonne5HT),col.names = c(" ","inclusion","1 year after treatment","5 year after treatment","inclusion","1 year after treatment","5 year after treatment"), align = "c",digits = 0) %>%
add_header_above(c(" "=1,"Radiotherapy alone" = 3, "Radiotherapy and goserelin" = 3)) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
footnote(general = "Data are median")
knitr::include_graphics("img/TableGETUG.png")
ggplot(DF) +
geom_boxplot(aes(x = bras, y = globalqol), fill = "wheat", color = "tomato4")
ggplot(DF) +
geom_boxplot(aes(x = bras, y = globalqol1), fill = "wheat", color = "tomato4")
ggplot(DF) +
geom_boxplot(aes(x = bras, y = globalqol5), fill = "wheat", color = "tomato4")
ggboxplot(data=DF,x="bras",y="globalqol")
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = "theme_classic()")
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = "theme_classic")
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = theme_classic())
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = pubr())
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = theme_pubr())
ggboxplot(data=DF,x="bras",y="globalqol",ggtheme = theme_bw())
ggboxplot(data=DF,x="bras",y="globalqol1",ggtheme = theme_bw())
ggboxplot(data=DF,x="bras",y="globalqol5",ggtheme = theme_bw())
ggboxplot(data=DF,x="bras",y="globalqol5",ggtheme = theme_classic())
ggboxplot(data=DF,x="bras",y="globalqol1",ggtheme = theme_classic())
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic())
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),merge=TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),merge=TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),merge=TRU
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans, en fonction du traitement réalisé")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette ="grey")
library(ggsci)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette ="lancet")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette ="lancet",ylab="globalqol score")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",panel.labs = c("pas d'hormonothérapie","hormonotherapie"))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",panel.labs = list(globalqol = c("pas d'hormonothérapie","hormonotherapie"))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",panel.labs = list(globalqol = c("pas d'hormonothérapie","hormonotherapie")))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",panel.labs = list("globalqol" = c("pas d'hormonothérapie","hormonotherapie")))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, notch = TRUE)
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, label = c("pas d'hormono","avec hormonothérapie"))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, label = c("pas d'hormono","avec hormonothérapie","pas d'hormono","avec hormonothérapie","pas d'hormono","avec hormonothérapie"))
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),merge=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
ggboxplot(data=DF,x="bras",y=c("globalqol","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
colname(DF$globalqol)
colnames(DF$globalqol)
colnames(DF)[colnames(DF) == "globalqol"]
colnames(DF)[colnames(DF) == "globalqol"] <- "à l'inclusion"
colnames(DF)[colnames(DF) == "globalqol1"] <- "à 1 an"
colnames(DF)[colnames(DF) == "globalqol5"] <- "à 5 ans"
colnames(DF)[colnames(DF) == "globalqol5"] <- "à 5 ans"
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","globalqol1","globalqol5"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
DF$bras
DF$bras[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"] <- "RT-HT"
DF$bras[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"] <- "RT seule"
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
DF$bras[DF$bras == "RADIOTHERAPIE EXCLUSIVE"] <- "RT seule"
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé")
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé : hormonothérapie et radiothérapie (RT-HT) ou radiothérpie seule ")
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé : hormonothérapie et radiothérapie (RT-HT) ou radiothérpie seule ", add=jitter)
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé : hormonothérapie et radiothérapie (RT-HT) ou radiothérpie seule ", add="jitter")
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé : hormonothérapie et radiothérapie (RT-HT) ou radiothérpie seule ")
colnames(DF)[colnames(DF) == "à l'inclusion"] <- "globalqol"
colnames(DF)[colnames(DF) == "à 1 an"] <- "globalqol1"
colnames(DF)[colnames(DF) == "à 5 ans"] <- "globalqol5"
DF$bras[DF$bras == "RT-HT"] <- "RADIOTHERAPIE HORMONOTHERAPIE"
DF$bras[DF$bras == "RT seule"] <- "RADIOTHERAPIE EXCLUSIVE"
effectif <- c(length(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol)]),
length(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol1)]),
length(DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol5)]),
length(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol)]),
length(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol1)]),
length(DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol5)]))
DF %>%
group_by(bras) %>%
shapiro_test(globalqol,globalqol1,globalqol5) %>%
cbind(.,effectif) %>%
kable(format = "html", escape = F, digits = 4) %>%
kable_styling(bootstrap_options = c("striped", "hover","condensed","responsive",full_width = F), position = "center")
ggqqplot(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol)])
ggqqplot(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol1)])
ggqqplot(DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$globalqol5)])
ggqqplot(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol)])
ggqqplot(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol1)])
ggqqplot(DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$globalqol5)])
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$globalqol[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$globalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$globalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin1[DF$bras == "RADIOTHERAPIE EXCLUSIVE"],DF$urin5[DF$bras == "RADIOTHERAPIE EXCLUSIVE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
wilcox.test(DF$urin1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"],DF$urin5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"], paired = TRUE)
# DÉFINITION DES VARIABLES DIFF à 1 an et 5 ans
DF$Diffglobalqol5 <- (DF$globalqol5 - DF$globalqol)
DF$Diffglobalqol1 <- (DF$globalqol1 - DF$globalqol)
DF$DiffIADL5<- (as.numeric(DF$score_IADL_5) - as.numeric(DF$score_IADL_0))
DF$DiffIADL1 <- (as.numeric(DF$score_IADL_1) - as.numeric(DF$score_IADL_0))
variables <- c("GQol Difference at 1 year","GQol Difference at 5 year","IADL Difference at 1 year","IADL Difference at 5 year")
colonne0RT <- c(
round(mean(DF$Diffglobalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$Diffglobalqol1)]),1),
round(mean(DF$Diffglobalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$Diffglobalqol5)]),1),
round(mean(DF$DiffIADL1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$DiffIADL1)]),1),
round(mean(DF$DiffIADL5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$DiffIADL5)]),1)
)
colonne0HT <- c(
round(mean(DF$Diffglobalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$Diffglobalqol1)]),1),
round(mean(DF$Diffglobalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$Diffglobalqol5)]),1),
round(mean(DF$DiffIADL1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$DiffIADL1)]),1),
round(mean(DF$DiffIADL5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$DiffIADL5)]),1)
)
colonneTest <- c(
round(t.test(DF$Diffglobalqol1~DF$bras)$p.value,3),
round(wilcox.test(DF$Diffglobalqol5~DF$bras)$p.value,3),
round(wilcox.test(DF$DiffIADL1~DF$bras)$p.value,3),
round(wilcox.test(DF$DiffIADL5~DF$bras)$p.value,3)
)
kable(cbind(variables,colonne0RT,colonne0HT,colonneTest),col.names = c("","Radiotherapy alone","Radiotherapy and goserelin","p-value")) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
shapiro.test(DF$Diffglobalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$Diffglobalqol1)])
shapiro.test(DF$Diffglobalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$Diffglobalqol1)])
shapiro.test(DF$Diffglobalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$Diffglobalqol5)])
shapiro.test(DF$Diffglobalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$Diffglobalqol5)])
shapiro.test(DF$DiffIADL1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$DiffIADL1)])
shapiro.test(DF$DiffIADL1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$DiffIADL1)])
shapiro.test(DF$DiffIADL5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$DiffIADL5)])
shapiro.test(DF$DiffIADL5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$DiffIADL5)])
DF$CATDiffglobalqol1 <- ifelse(DF$Diffglobalqol1 < -10,1,0)
DF$CATDiffglobalqol5 <- ifelse(DF$Diffglobalqol5 < -10,1,0)
DF$CATDiffglobalqol1bis <- ifelse(DF$Diffglobalqol1 < 0,1,0)
DF$CATDiffglobalqol5bis <- ifelse(DF$Diffglobalqol5 < 0,1,0)
a <- (round(mean(DF$CATDiffglobalqol1[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$CATDiffglobalqol1)]),2)*100)
b <- round(mean(DF$CATDiffglobalqol1[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$CATDiffglobalqol1)]),2)*100
c <- round(mean(DF$CATDiffglobalqol5[DF$bras == "RADIOTHERAPIE EXCLUSIVE" & !is.na(DF$CATDiffglobalqol5)]),2)*100
d <- round(mean(DF$CATDiffglobalqol5[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE" & !is.na(DF$CATDiffglobalqol5)]),2)*100
tableau <- table(DF$CATDiffglobalqol1,DF$bras)
test1 <- chisq.test(tableau)
tableau2 <- table(DF$CATDiffglobalqol5,DF$bras)
test2 <- chisq.test(tableau2)
tableaubis <- table(DF$CATDiffglobalqol1bis,DF$bras)
test1bis <- chisq.test(tableaubis)
tableau2bis <- table(DF$CATDiffglobalqol5bis,DF$bras)
test2bis <- chisq.test(tableau2bis)
kable(addmargins(tableau)) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
test1
kable(addmargins(tableau2)) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
test2
kable(addmargins(tableaubis)) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
test1bis
kable(addmargins(tableau2bis)) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
test2bis
colnames(DF)[colnames(DF) == "globalqol"] <- "à l'inclusion"
colnames(DF)[colnames(DF) == "globalqol1"] <- "à 1 an"
colnames(DF)[colnames(DF) == "globalqol5"] <- "à 5 ans"
DF$bras[DF$bras == "RADIOTHERAPIE HORMONOTHERAPIE"] <- "RT-HT"
DF$bras[DF$bras == "RADIOTHERAPIE EXCLUSIVE"] <- "RT seule"
ggboxplot(data=DF,x="bras",y=c("à l'inclusion","à 1 an","à 5 ans"),ggtheme = theme_classic(),combine=TRUE,title="Score de qualité de vie à l'inclusion, à 1 an et à 5 ans",palette = "lancet",ylab="globalqol score",fill="grey",short.panel.labs = TRUE, xlab = "Traitement réalisé : hormonothérapie et radiothérapie (RT-HT) ou radiothérpie seule ")
colnames(DF)[colnames(DF) == "à l'inclusion"] <- "globalqol"
colnames(DF)[colnames(DF) == "à 1 an"] <- "globalqol1"
colnames(DF)[colnames(DF) == "à 5 ans"] <- "globalqol5"
DF$bras[DF$bras == "RT-HT"] <- "RADIOTHERAPIE HORMONOTHERAPIE"
DF$bras[DF$bras == "RT seule"] <- "RADIOTHERAPIE EXCLUSIVE"
autostats::reglog(DF,y="deces", explicatives = c("Age","SEXE","obesite","ATCD.CV","IRC",'K.actif','HBPM',"HNF","hydroxychloroquine","Essai.clinique.COVID..OUI.NON.","Diabete","Patho.Chronique.Respi","Dyslipidemie"),keep = c("obesite","HBPM"),exit="html",stability = TRUE)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(table1)
library(readxl)
DF <- read_excel("~/MEGA/ARTICLES/CDD/COVID19-HUON/COHORTE COVID-19 Fichier pour stats.xlsx",na = c("NR","NA"))
#devtools::install_github("TanguyPerennec/autostats")
library(autostats)
nrow(DF)
DF$`durée (j)...52`
DF$`durée (j)...56`
DF$`durée (j)...60`
DF$`durée (J)...68`
DF$durée...27 <- as.numeric(DF$durée...27)
table1::table1(~`Lopinavir/ritonavir`+posologie...26+durée...27, data=DF)
DF$durée...30 <- as.numeric(DF$durée...30)
table1::table1(~`remdesivir`+posologie...29+durée...30, data=DF)
DF$durée...33 <- as.numeric(DF$durée...33)
table1::table1(~`hydroxychloroquine`+posologie...32+durée...33, data=DF)
DF$durée...36 <- as.numeric(DF$durée...36)
table1::table1(~`Chloroquine`+durée...36, data=DF) #Pas de posologie disponible
DF$durée...39 <- as.numeric(DF$durée...39)
table1::table1(~`IFN-B`+posologie...38+durée...39, data=DF)
DF$durée...42 <- as.numeric(DF$durée...42)
table1::table1(~`tocilizumab`+posologie...41+durée...42, data=DF)
DF$durée...45 <- as.numeric(DF$durée...45)
table1::table1(~`Sarilumab (KEVZARA) ou placebo`+posologie...44+durée...45, data=DF)
DF$posologie...47[DF$posologie...47 == "20mg/j"] <- "20mgx1/j"
DF$durée...48 <- as.numeric(DF$durée...48)
table1::table1(~`corticoïdes`+posologie...47+durée...48, data=DF)
format_data(DF) ->DF
DF$`ATB 1ère ligne`[DF$`ATB 1ère ligne` != "non"] <- "oui"
Rstatable::table1(DF[,c(1:14,65)],y = "ATB 1ère ligne",exit="html",overall =FALSE)
# Les patients décédés sont exclus
DF_new <- DF[DF$`décès (OUI/NON)` == "non",]
# exclusion des séjours en cours
DF_new$`Date de sortie/décès`[DF_new$`Date de sortie/décès` == "séjour en cours"] <- NA
as.numeric(DF_new$`Date de sortie/décès`) -> DF_new$`Date de sortie/décès`
DF_new$`Date de sortie/décès` <- as.Date(DF_new$`Date de sortie/décès`,origin = "1899-12-30",optional=TRUE)
DF_new[2,"Date de sortie/décès"] <- "2020-04-22" #correction de l'erreur
DF_new$`Date d\'entrée` <- as.Date(DF_new$`Date d\'entrée`,optional=TRUE)
DF_new$survie <- DF_new$`Date de sortie/décès` - DF_new$`Date d\'entrée`
# on exclu les patients ayant eu un début de symptome en hospitalisation
as.Date(as.numeric(DF_new$`Date début des symptômes`),origin = "1899-12-30",optional=TRUE) -> DF_new$`Date début des symptômes`
DF_new[DF_new$`Date début des symptômes` - DF_new$`Date d\'entrée` <= 0,] -> DF_new
library(survival)
library(survminer)
fit <- survfit(Surv(time = survie)~1, data = DF_new)
ggsurvplot(fit,risk.table = TRUE,xlab='Temps (jours)',ylab='Hospitalisation',break.time.by=10)
summary(coxph(formula = Surv(time = survie)~Age+obesite+SEXE+IRA+IRC+`K actif`+`ATCD CV`+Diabete+`Patho Chronique Respi`,data=DF_new))->model_surv
model_surv$coefficients[,c(2,5)] -> table
colnames(table) <- c("HR","p-value")
model_surv$conf.int[,3] -> confint_low
model_surv$conf.int[,4] -> confint_up
confint <- vector()
for (n in seq(confint_low)){
paste0(" [ ",round(confint_low[n],2),";",round(confint_up[n],2)," ] ") -> confint[n]
}
as.data.frame(table) -> table
as.data.frame(confint) -> confint
rownames.rslt <- c("Age", "obésité", "Sexe (M)","IRA","IRC","Cancer actif","ATCD CV","Diabète","Pathologie respiratoire chronique")
rslt <- cbind(rownames.rslt,table[,1],confint,table[,2])
colnames(rslt) <- c("Caractéristiques","HR","IC95%","p-value")
rownames.rslt <- c("Age", "obésité", "Sexe (M)","IRA","IRC","Cancer actif","ATCD CV","Diabète","Pathologie respiratoire chronique")
library(flextable)
round(rslt[,2],2) -> rslt[,2]
round(rslt[,4],3) -> rslt[,4]
flextable(rslt) %>%
autofit()
fit <- survfit(Surv(time = survie)~IRA, data = DF_new)
ggsurvplot(fit,risk.table = TRUE,pval=TRUE,conf.int=FALSE,xlab='Temps (jours)',ylab="Hospitalisation",break.time.by=10)
fit <- survfit(Surv(time = survie)~SEXE, data = DF_new)
ggsurvplot(fit,risk.table = TRUE,pval=TRUE,conf.int=FALSE,xlab='Temps (jours)',ylab="Hospitalisation",break.time.by=10)
DF_new$Age_c <- cut(DF_new$Age, c(0,60,75,80,100))
fit <- survfit(Surv(time = survie)~Age_c, data = DF_new)
ggsurvplot(fit,risk.table = TRUE,pval=TRUE,conf.int=FALSE,xlab='Temps (jours)',ylab="Hospitalisation",break.time.by=10)
DF_new$Age_c <- cut(DF_new$Age, c(0,60,100))
fit <- survfit(Surv(time = survie)~Age_c, data = DF_new)
ggsurvplot(fit,risk.table = TRUE,pval=TRUE,conf.int=FALSE,xlab='Temps (jours)',ylab="Hospitalisation",break.time.by=10)
# exclure les > 80
DF2 <- DF[DF$Age < 80,]
make.names(colnames(DF2)) ->colnames(DF2)
addmargins(table(DF2$Age_c,DF2$admission.réanimation..OUI.NON.))
autostats::reglog(DF,y="deces", explicatives = c("Age","SEXE","obesite","ATCD.CV","IRC",'K.actif','HBPM',"HNF","hydroxychloroquine","Essai.clinique.COVID..OUI.NON.","Diabete","Patho.Chronique.Respi","Dyslipidemie"),keep = c("obesite","HBPM"),exit="html",stability = TRUE)
